From c0a6f1a4eef2ba76d6ff3559540eeb9bccaaaeee Mon Sep 17 00:00:00 2001
From: Andrei Karas <akaras@inbox.ru>
Date: Wed, 15 Dec 2010 01:00:07 +0200
Subject: [PATCH 101/226] Port from eathena script npc moving commands. But
 still not functional because npc movinf features not ported.

---
 src/map/script.c | 47 +++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 47 insertions(+)

diff --git a/src/map/script.c b/src/map/script.c
index ed0332c..d787956 100644
--- a/src/map/script.c
+++ b/src/map/script.c
@@ -395,6 +395,9 @@ int  buildin_movenpc (struct script_state *st); // [MouseJstr]
 int  buildin_npcwarp (struct script_state *st); // [remoitnane]
 int  buildin_message (struct script_state *st); // [MouseJstr]
 int  buildin_npctalk (struct script_state *st); // [Valaris]
+int  buildin_npcwalkto (struct script_state *st); // [Valaris]
+int  buildin_npcstop (struct script_state *st); // [Valaris]
+int  buildin_npcspeed (struct script_state *st); // [Valaris]
 int  buildin_hasitems (struct script_state *st);    // [Valaris]
 int  buildin_getlook (struct script_state *st); //Lorky [Lupus]
 int  buildin_getsavepoint (struct script_state *st);    //Lorky [Lupus]
@@ -808,6 +811,12 @@ struct
     {
     buildin_npctalk, "npctalk", "*"},   // [Valaris]
     {
+    buildin_npcspeed, "npcspeed", "i"}, // [Valaris]
+    {
+    buildin_npcwalkto, "npcwalkto", "ii"}, // [Valaris]
+    {
+    buildin_npcstop, "npcstop", ""}, // [Valaris]
+    {
     buildin_hasitems, "hasitems", "*"}, // [Valaris]
     {
     buildin_mobcount, "mobcount", "ss"},
@@ -7397,6 +7406,44 @@ BUILDIN_FUNC(npctalk)
     return 0;
 }
 
+// change npc walkspeed [Valaris]
+BUILDIN_FUNC(npcspeed)
+{
+    struct npc_data *nd = (struct npc_data *)map_id2bl(st->oid);
+    int x = 0;
+
+    x = script_getnum(st, 2);
+    if(nd)
+        nd->speed = x;
+
+    return 0;
+}
+
+// make an npc walk to a position [Valaris]
+BUILDIN_FUNCU(npcwalkto)
+{
+//    struct npc_data *nd = (struct npc_data *)map_id2bl(st->oid);
+//    int x = 0, y = 0;
+
+//    x = script_getnum(st, 2);
+//    y = script_getnum(st, 3);
+//    if(nd)
+//        unit_walktoxy(&nd->bl, x, y,0);
+
+    return 0;
+}
+
+// stop an npc's movement [Valaris]
+BUILDIN_FUNCU(npcstop)
+{
+//    struct npc_data *nd = (struct npc_data *)map_id2bl(st->oid);
+
+//    if(nd)
+//        unit_stop_walking(&nd->bl, 1);
+
+    return 0;
+}
+
 /*==========================================
  * hasitems (checks to see if player has any
  * items on them, if so will return a 1)
-- 
2.1.0

